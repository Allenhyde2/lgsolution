<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>canD 솔루션 개발 일정표</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8f9fa;
        }

        /* Spreadsheet Grid Styles */
        .sheet-container {
            overflow: auto;
            max-height: calc(100vh - 60px);
            border: 1px solid #d1d5db;
            background-color: white;
        }

        table {
            border-collapse: collapse;
            min-width: 100%;
            font-size: 13px;
        }

        th, td {
            border: 1px solid #e5e7eb;
            padding: 8px;
            white-space: nowrap;
            height: 32px;
        }

        /* Header Styles */
        th {
            background-color: #f3f4f6;
            color: #374151;
            font-weight: 600;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        /* Row Number Column */
        .row-num {
            background-color: #f9fafb;
            color: #6b7280;
            text-align: center;
            width: 40px;
            font-size: 11px;
            user-select: none;
        }

        /* Cell Interaction */
        td:focus {
            outline: 2px solid #10b981;
            outline-offset: -2px;
            background-color: white;
        }

        /* Timeline Cell */
        .timeline-cell {
            text-align: center;
            cursor: pointer;
            transition: background-color 0.1s;
            width: 60px;
        }
        
        .timeline-cell:hover {
            background-color: #f0fdf4;
        }

        .timeline-cell.active {
            background-color: #d1fae5;
            color: #047857;
            font-weight: bold;
        }

        /* Column Widths */
        .col-lv1 { width: 100px; }
        .col-lv2 { width: 120px; }
        .col-lv3 { width: 250px; }
        .col-lv4 { width: 150px; }
        
        /* Loading & Error States */
        #loading-message {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            color: #4b5563;
            font-weight: 500;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden text-gray-800">

    <!-- Toolbar -->
    <header class="bg-white border-b border-gray-200 px-4 py-2 flex items-center justify-between shadow-sm z-20 h-[60px]">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-green-600 rounded flex items-center justify-center text-white font-bold text-lg">S</div>
            <div>
                <h1 class="font-bold text-lg leading-tight">canD 솔루션 개발 일정표</h1>
                <p class="text-xs text-gray-500">자동 저장됨 • 편집 가능</p>
            </div>
        </div>
        <div class="flex gap-2">
            <button onclick="exportToCSV()" class="flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm font-medium transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                CSV 내보내기
            </button>
        </div>
    </header>

    <!-- Spreadsheet Area -->
    <main class="flex-1 bg-gray-100 p-2 overflow-hidden">
        <div id="loading-message">
            데이터를 불러오는 중입니다...
        </div>
        
        <div class="sheet-container rounded shadow-sm h-full hidden" id="sheet-container">
            <table id="schedule-table">
                <thead>
                    <tr>
                        <th class="w-10">#</th>
                        <th class="col-lv1">Lv1 (단계)</th>
                        <th class="col-lv2">Lv2 (기능 그룹)</th>
                        <th class="col-lv3">Lv3 (상세 업무)</th>
                        <th class="col-lv4">Lv4 (담당/난이도)</th>
                        <!-- Weeks Headers -->
                        <th class="w-16">1월(1주)</th>
                        <th class="w-16">1월(2주)</th>
                        <th class="w-16">1월(3주)</th>
                        <th class="w-16">1월(4주)</th>
                        <th class="w-16">2월(5주)</th>
                        <th class="w-16">2월(6주)</th>
                        <th class="w-16">2월(7주)</th>
                        <th class="w-16">2월(8주)</th>
                        <th class="w-16">3월(9주)</th>
                        <th class="w-16">3월(10주)</th>
                        <th class="w-16">3월(11주)</th>
                        <th class="w-16">3월(12주)</th>
                    </tr>
                </thead>
                <tbody id="table-body" class="bg-white">
                    <!-- Rows will be populated by JS -->
                </tbody>
            </table>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // Initial Data
                const scheduleData = [
                    ["Phase 1", "공통/기반", "프로젝트 세팅 및 DB 설계", "Dev A / 하", [1,0,0,0,0,0,0,0,0,0,0,0]],
                    ["", "", "API 공통 모듈 & 인증(JWT)", "Dev B / 하", [1,0,0,0,0,0,0,0,0,0,0,0]],
                    ["", "", "좋아요/북마크 공통 모듈", "Dev A / 하", [0,0,0,1,0,0,0,0,0,0,0,0]],
                    ["Phase 1", "회원", "프로필 조회/수정 기능", "Dev B / 하", [1,0,0,0,0,0,0,0,0,0,0,0]],
                    ["", "", "마이페이지 활동 정보 조회", "Dev B / 하", [1,0,0,0,0,0,0,0,0,0,0,0]],
                    ["", "", "팔로우/언팔로우 및 목록", "Dev B / 하", [0,1,0,0,0,0,0,0,0,0,0,0]],
                    ["Phase 1", "매거진", "매거진 목록/상세 API", "Dev A / 하", [1,0,0,0,0,0,0,0,0,0,0,0]],
                    ["", "", "매거진 북마크/공유 기능", "Dev A / 하", [0,1,0,0,0,0,0,0,0,0,0,0]],
                    ["Phase 1", "홈/검색", "메인 배너/인기 콘텐츠 노출", "Dev A / 하", [1,0,0,0,0,0,0,0,0,0,0,0]],
                    ["", "", "통합 검색 (매거진, 포스트)", "Dev A / 하", [0,1,0,0,0,0,0,0,0,0,0,0]],
                    ["Phase 1", "알림/이벤트", "알림 목록 조회 (단순)", "Dev B / 하", [0,1,0,0,0,0,0,0,0,0,0,0]],
                    ["", "", "이벤트 목록/상세 페이지", "Dev A / 하", [0,0,1,0,0,0,0,0,0,0,0,0]],
                    ["", "", "이벤트 참여 신청 폼", "Dev A / 하", [0,0,1,0,0,0,0,0,0,0,0,0]],
                    ["Phase 1", "관리자", "금칙어/태그/배지 관리", "Dev B / 하", [0,0,1,0,0,0,0,0,0,0,0,0]],
                    ["", "", "공지사항 및 약관 관리", "Dev B / 하", [0,0,1,0,0,0,0,0,0,0,0,0]],
                    ["", "", "크리에이터 회원 관리", "Dev B / 하", [0,0,0,1,0,0,0,0,0,0,0,0]],
                    ["Phase 1", "콘텐츠", "리뷰/Q&A 조회 (View)", "Dev A / 하", [0,0,0,1,0,0,0,0,0,0,0,0]],
                    ["Phase 1", "배포", "1차 통합 테스트 및 MVP 배포", "Dev B / -", [0,0,0,1,0,0,0,0,0,0,0,0]],
                    ["Phase 2", "포스트", "작성 (이미지/영상 업로드)", "Dev A / 상", [0,0,0,0,1,0,0,0,0,0,0,0]],
                    ["", "", "임시 저장 및 태그 연동", "Dev A / 중", [0,0,0,0,1,0,0,0,0,0,0,0]],
                    ["", "", "피드 알고리즘 (인기/팔로잉)", "Dev A / 상", [0,0,0,0,0,1,0,0,0,0,0,0]],
                    ["Phase 2", "메시징", "채팅 서버 구축 (Socket)", "Dev B / 상", [0,0,0,0,1,0,0,0,0,0,0,0]],
                    ["", "", "채팅방 생성/참여자 관리", "Dev B / 상", [0,0,0,0,1,0,0,0,0,0,0,0]],
                    ["", "", "실시간 메시지/Push 알림", "Dev B / 상", [0,0,0,0,0,1,0,0,0,0,0,0]],
                    ["", "", "미디어 전송/나가기 처리", "Dev B / 상", [0,0,0,0,0,1,0,0,0,0,0,0]],
                    ["Phase 2", "투표/댓글", "계층형 댓글(대댓글)", "Dev A / 중", [0,0,0,0,0,1,0,0,0,0,0,0]],
                    ["", "", "A/B 투표 생성/수정", "Dev A / 상", [0,0,0,0,0,0,1,0,0,0,0,0]],
                    ["", "", "투표 참여/실시간 집계", "Dev A / 상", [0,0,0,0,0,0,1,0,0,0,0,0]],
                    ["Phase 2", "Candy", "포인트 정책/적립/사용", "Dev B / 상", [0,0,0,0,0,0,1,0,0,0,0,0]],
                    ["", "", "포인트 이력/무결성 검증", "Dev B / 상", [0,0,0,0,0,0,1,0,0,0,0,0]],
                    ["Phase 2", "Quest", "퀘스트/트리거 생성(Admin)", "Dev B / 상", [0,0,0,0,0,0,0,1,0,0,0,0]],
                    ["", "", "사용자 행동 감지 시스템", "Dev B / 상", [0,0,0,0,0,0,0,1,0,0,0,0]],
                    ["", "", "달성 검증/보상 지급", "Dev B / 상", [0,0,0,0,0,0,0,0,1,0,0,0]],
                    ["", "", "현황 시각화/보상 UI", "Dev A / 중", [0,0,0,0,0,0,0,0,1,0,0,0]],
                    ["Phase 2", "기타", "리뷰/Q&A 답변/베스트 선정", "Dev A / 중", [0,0,0,0,0,0,0,1,0,0,0,0]],
                    ["", "", "유해 콘텐츠 신고(FE)", "Dev A / 중", [0,0,0,0,0,0,0,1,0,0,0,0]],
                    ["", "", "마이홈 (쓴글/참여 모음)", "Dev A / 중", [0,0,0,0,0,0,0,0,1,0,0,0]],
                    ["Phase 2", "관리/통계", "봇(Bot) 자동 알림 설정", "Dev B / 중", [0,0,0,0,0,0,0,0,1,0,0,0]],
                    ["", "", "인기 콘텐츠 선정 대시보드", "Dev A / 중", [0,0,0,0,0,0,0,0,0,1,0,0]],
                    ["", "", "콘텐츠 반응 통계 집계", "Dev A / 중", [0,0,0,0,0,0,0,0,0,1,0,0]],
                    ["", "", "신고 처리/자동 제재", "Dev B / 상", [0,0,0,0,0,0,0,0,0,1,0,0]],
                    ["", "", "이벤트 당첨자 추첨", "Dev B / 중", [0,0,0,0,0,0,0,0,0,1,0,0]],
                    ["Phase 2", "최적화/QA", "이미지 로딩 최적화/캐싱", "Dev A / -", [0,0,0,0,0,0,0,0,0,0,1,0]],
                    ["", "", "UI/UX 버그 수정", "Dev A / -", [0,0,0,0,0,0,0,0,0,0,1,0]],
                    ["", "", "대용량 쿼리 튜닝/보안", "Dev B / -", [0,0,0,0,0,0,0,0,0,0,1,0]],
                    ["Phase 2", "최종", "최종 테스트/런칭 준비", "Dev A / -", [0,0,0,0,0,0,0,0,0,0,0,1]],
                    ["", "", "운영 배포/모니터링", "Dev B / -", [0,0,0,0,0,0,0,0,0,0,0,1]]
                ];

                const tableBody = document.getElementById('table-body');
                if (!tableBody) throw new Error("테이블 본문을 찾을 수 없습니다.");

                // Render Table
                scheduleData.forEach((row, index) => {
                    const tr = document.createElement('tr');
                    
                    // Row Number
                    const tdNum = document.createElement('td');
                    tdNum.className = 'row-num';
                    tdNum.textContent = index + 1;
                    tr.appendChild(tdNum);

                    // Info Columns (Lv1 ~ Lv4)
                    for (let i = 0; i < 4; i++) {
                        const td = document.createElement('td');
                        td.contentEditable = "true";
                        td.textContent = row[i];
                        td.className = i === 0 || i === 1 ? 'font-medium text-gray-900 bg-gray-50' : 'text-gray-700';
                        
                        // Style placeholder for empty repetitive cells
                        if (row[i] === "" && i < 2) {
                           td.style.backgroundColor = 'white';
                        }
                        tr.appendChild(td);
                    }

                    // Timeline Columns
                    const timelineData = row[4];
                    timelineData.forEach(isActive => {
                        const td = document.createElement('td');
                        td.className = 'timeline-cell';
                        if (isActive) {
                            td.classList.add('active');
                            td.textContent = '■';
                        }
                        
                        // Toggle functionality
                        td.onclick = function() {
                            this.classList.toggle('active');
                            this.textContent = this.classList.contains('active') ? '■' : '';
                        };
                        
                        tr.appendChild(td);
                    });

                    tableBody.appendChild(tr);
                });

                // Show Content
                document.getElementById('loading-message').style.display = 'none';
                document.getElementById('sheet-container').classList.remove('hidden');

            } catch (error) {
                console.error("Rendering Error:", error);
                const loadingMsg = document.getElementById('loading-message');
                loadingMsg.innerHTML = `<div class="text-red-500">오류가 발생했습니다.<br>${error.message}</div>`;
            }
        });

        // Export to CSV Function
        function exportToCSV() {
            let csvContent = "\uFEFF"; // BOM for UTF-8 (Excel support)
            
            // Header
            const headerRow = ["Lv1", "Lv2", "Lv3", "Lv4", "1월(1주)", "1월(2주)", "1월(3주)", "1월(4주)", "2월(5주)", "2월(6주)", "2월(7주)", "2월(8주)", "3월(9주)", "3월(10주)", "3월(11주)", "3월(12주)"];
            csvContent += headerRow.join(",") + "\n";

            // Rows
            const rows = document.querySelectorAll('#table-body tr');
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                let rowData = [];
                
                // Info cells (skip index 0 which is row number)
                for (let i = 1; i <= 4; i++) {
                    // Escape commas in text
                    let text = cells[i].innerText.replace(/"/g, '""');
                    if (text.includes(',')) text = `"${text}"`;
                    rowData.push(text);
                }

                // Timeline cells
                for (let i = 5; i < cells.length; i++) {
                    rowData.push(cells[i].classList.contains('active') ? "■" : "");
                }

                csvContent += rowData.join(",") + "\n";
            });

            // Download
            const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
            const link = document.createElement("a");
            const url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", "development_schedule.csv");
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
